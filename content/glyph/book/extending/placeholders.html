<!DOCTYPE html> 
<html lang="en"> 
	<head> 
		<title>Using Placeholders &ndash; Glyph Documentation</title> 



		<meta charset="utf-8" /> 
		<meta name="author" content="Fabio Cevasco" /> 
		<meta name="copyright" content="Fabio Cevasco" /> 
		<meta name="robots" content="all, follow" /> 
		<meta name="Revisit-After" content="2 Days" /> 
		<meta name="language" content="en" /> 
		<meta name="target_country" content="en-us" /> 
		<meta name="country" content="United States" /> 
		<meta name="description" content="H3RALD - Fabio Cevasco's Web Site" /> 

		<meta name="keywords" content="h3rald, fabio cevasco, glyph" /> 
		<link rel="shortcut icon" href="/favicon.png" type="image/png" /> 
		<meta content="44.388041;9.073248" name="ICBM" /> 


		<link rel="stylesheet" type="text/css" href="/styles/html5reset.css" /> 
		<link rel="stylesheet" type="text/css" href="/styles/style.css" /> 

		<!--[if lte IE 8]>
		<script src="/js/html5.js" type="text/javascript"></script>
		<![endif]--> 
	</head> 
	<body> 
		<!--[if lte IE 6]>
		<div id="ie-warning">
			This site is not compatible with Internet Explorer 6 or lower. You should consider using a more modern browser for a better &ndash; and <em>safer</em> &ndash; web experience. [<a href="http://browsehappy.com/browsers/">Read More &raquo;</a>]
		</div>
		<![endif]--> 

		<section id="container"> 

			<header class="page"> 
				<nav class="home-link"> 
					<a href="/"> 
						<img src="/images/h3rald_small.png" alt="H3RALD" class="default"/> 
						<![if !IE]> 
						<img src="/images/h3rald_hover_small.png" alt="H3RALD" class="hover"/> 
						<![endif]> 
					</a> 
				</nav> 

				<nav class="section"> 
					/<a href="/glyph/" rel="archives">GLYPH</a> 
				</nav> 

			</header> 
			<article class="page"> 
				<header> 
					<hgroup> 
					<h1>Using Placeholders</h1> 
					<h2>Glyph Documentation</h2>
					</hgroup> 
				</header> 
				<section id="body-text" class="hyphenate glyph-book"> 

							<nav><a href="/glyph/book/extending/bookmarks_headers.html">Bookmarks and Headers &larr;</a><a href="/glyph/book/index.html">Contents</a><a href="/glyph/book/extending/validators.html">&rarr; Using Validators</a></nav>
								<p>Sometimes you may need to access some data that will not be available until the entire document has been fully parsed and analyzed. For example, in order to be able to validate internal links, it is necessary to know in advance if the bookmark ID referenced in the link exists or not, either before (that&#8217;s easy) or even <em>after</em> the link.</p>
<p>Here&#8217;s the source code of the <a href="/glyph/book/macros/macros_inline.html#m_link"><code>link</code></a> macro:</p>
	<div class="CodeRay">
  <div class="code"><pre><span class="no"> 1</span> macro <span class="sy">:link</span> <span class="r">do</span>
<span class="no"> 2</span>   href, title = <span class="iv">@params</span>
<span class="no"> 3</span>   <span class="r">if</span> href.match <span class="rx"><span class="dl">/</span><span class="k">^#</span><span class="dl">/</span></span> <span class="r">then</span>
<span class="no"> 4</span>     anc = href.gsub(<span class="rx"><span class="dl">/</span><span class="k">^#</span><span class="dl">/</span></span>, <span class="s"><span class="dl">'</span><span class="dl">'</span></span>).to_sym
<span class="no"> 5</span>     bmk = bookmark? anc
<span class="no"> 6</span>     <span class="r">if</span> bmk <span class="r">then</span>
<span class="no"> 7</span>       title ||= bmk[<span class="sy">:title</span>]
<span class="no"> 8</span>     <span class="r">else</span>
<span class="no"> 9</span>       plac = placeholder <span class="r">do</span> |document|
<span class="no"><strong>10</strong></span>         macro_error <span class="s"><span class="dl">&quot;</span><span class="k">Bookmark '</span><span class="il"><span class="idl">#{</span>anc<span class="idl">}</span></span><span class="k">' does not exist</span><span class="dl">&quot;</span></span> <span class="r">unless</span> document.bookmarks[anc] 
<span class="no">11</span>         document.bookmarks[anc][<span class="sy">:title</span>]
<span class="no">12</span>       <span class="r">end</span>
<span class="no">13</span>       title ||= plac
<span class="no">14</span>     <span class="r">end</span>
<span class="no">15</span>   <span class="r">end</span>
<span class="no">16</span>   title ||= href
<span class="no">17</span>   <span class="s"><span class="dl">%{</span><span class="k">&lt;a href=&quot;</span><span class="il"><span class="idl">#{</span>href<span class="idl">}</span></span><span class="k">&quot;&gt;</span><span class="il"><span class="idl">#{</span>title<span class="idl">}</span></span><span class="k">&lt;/a&gt;</span><span class="dl">}</span></span>
<span class="no">18</span> <span class="r">end</span></pre></div>
</div>

	<p>If there&#8217;s already a bookmark stored in the current document, then it is possible to retrieve its title and use it as link text. Otherwise, it is necessary to wait until the entire document has been fully processed and then check if the bookmark exists. To do so, use the <code>placeholder</code> method. When called, this method returns an unique placeholder, which is then substituted with the value of the block, right before the document is finalized.</p>
<p>Within the <code>placeholder</code> block, the <code>document</code> parameter is, by all means, the fully analyzed document.</p>
							<nav><a href="/glyph/book/extending/bookmarks_headers.html">Bookmarks and Headers &larr;</a><a href="/glyph/book/index.html">Contents</a><a href="/glyph/book/extending/validators.html">&rarr; Using Validators</a></nav>
				</section> 
			</article> 


			<footer> 
				<section class="ads"> 
					<script type="text/javascript"><!--
						google_ad_client = "pub-2871497824158668";
						/* 728x90, created 9/10/10 */
						google_ad_slot = "3963343166";
						google_ad_width = 728;
						google_ad_height = 90;
						//-->
					</script> 
					<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"> 
					</script> 
				</section> 
				<section> 
					<nav> 
						<a href="/about/">ABOUT</a>|<a href="/contact/">CONTACT</a> 
					</nav> 
					<p>H3RALD Web Site v8.1 &mdash; &copy; 2010 &mdash; <em>Fabio Cevasco</em></p> 
				</section> 
			</footer> 
		</section><!-- #container end --> 
		<script src="http://www.google.com/jsapi?key=ABQIAAAAr6RY1Z6dchG_sX9WDLSy3xRlq2n1sm52B5HDRR5tm6o8XM18FhR56xHNNH6CsX86uN5VoTrglpyOyQ" type="text/javascript"></script> 
		<!-- <script src="/js/jquery.js" type="text/javascript"></script> --> 
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> 
		<script src="/js/jquery-timeago.js" type="text/javascript"></script> 
		<script src="/js/jquery-easing.js" type="text/javascript"></script> 
		<script src="/js/jquery-fancybox.js" type="text/javascript"></script> 
		<script src="/js/jquery-toc.js" type="text/javascript"></script> 
		<script src="/js/date.js" type="text/javascript"></script> 
		<script src="/js/feeds.js" type="text/javascript"></script> 
		<script src="/js/search.js" type="text/javascript"></script> 
		<script src="/js/hyphenator.min.js" type="text/javascript"></script> 
		<script src="/js/init.js" type="text/javascript"></script> 
		<!-- Start Google Analytics --> 
		<script type="text/javascript"> 
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-18587377-1']);
			_gaq.push(['_trackPageview']);

			(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		</script> 
		<!-- End Google Analytics --> 
		<!-- Start of StatCounter Code --> 
		<script type="text/javascript"> 
			var sc_project=6193656; 
			var sc_invisible=1; 
			var sc_security="57f7ee2a"; 
		</script> 
		<script type="text/javascript" src="http://www.statcounter.com/counter/counter_xhtml.js"></script> 
		<!-- End of StatCounter Code --> 
	</body> 
</html>