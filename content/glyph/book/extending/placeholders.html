<!DOCTYPE html> 
<html lang="en"> 
	<head> 
    <title>Using Placeholders - Glyph</title> 
		<link href='http://fonts.googleapis.com/css?family=Crimson+Text:400,400italic,600,600italic,700,700italic' rel='stylesheet' type='text/css'>
		
		
		
		<meta charset="utf-8" />
		<meta name="author" content="Fabio Cevasco" />
		<meta name="copyright" content="Fabio Cevasco" />
		<meta name="robots" content="all, follow" />
		<meta name="Revisit-After" content="2 Days" />
		<meta name="language" content="en" />
		<meta name="target_country" content="en-us" />
		<meta name="country" content="United States" />
                <meta name="readability-verification" content="XmaVzRjmcFL5Bb2Fu9TZVdDKzhA3apQdxexTB2rK"/>
		<meta name="description" content="H3RALD - Fabio Cevasco's Web Site" />
		
		<meta name="keywords" content="h3rald, fabio cevasco, glyph" />
		<link rel="shortcut icon" href="/favicon.png" type="image/png" /> 
		<meta content="44.388041;9.073248" name="ICBM" />

		<link rel="stylesheet" type="text/css" href="/styles/html5reset.css" />
		<link rel="stylesheet" type="text/css" href="/styles/style.css" />

    <script src="http://www.google.com/jsapi?key=ABQIAAAAr6RY1Z6dchG_sX9WDLSy3xRlq2n1sm52B5HDRR5tm6o8XM18FhR56xHNNH6CsX86uN5VoTrglpyOyQ" type="text/javascript"></script>
		<script src="/js/sevenup.js" type="text/javascript"></script>
		<script src="/js/sevenup_black.js" type="text/javascript"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript"></script>
		<script src="/js/jquery-timeago.js" type="text/javascript"></script>
		<script src="/js/jquery-easing.js" type="text/javascript"></script>
		<script src="/js/jquery-fancybox.js" type="text/javascript"></script>
		<script src="/js/date.js" type="text/javascript"></script>
		<script src="/js/feeds.js" type="text/javascript"></script>
		<script src="/js/hyphenator.js" type="text/javascript"></script>
		<script src="/js/init.js" type="text/javascript"></script>
		<script src="/js/search.js" type="text/javascript"></script>
	</head>
	<body>
		<section id="container">
			
				<header class="page">
	<nav class="home-link">
		<a href="/">
			<img src="/images/h3rald_small.png" alt="H3RALD" class="default"/>
			<![if !IE]>
			<img src="/images/h3rald_hover_small.png" alt="H3RALD" class="hover"/>
			<![endif]>
		</a>
	</nav>
	
	<nav class="section">
		/<a href="/glyph/" rel="glyph">GLYPH</a>
	</nav>
	
</header>
				<article class="page glyph-book">
					<header>
	<hgroup>
		<h1>Using Placeholders</h1> 
		<h2>Glyph</h2>
	</hgroup>
  </header>
					<section id="body-text" class="hyphenate glyph-book">

							<nav class="navigation"><a href="/glyph/book/extending/bookmarks_headers.html">Bookmarks and Headers</a> | <a href="/glyph/book/index.html">Contents</a> | <a href="/glyph/book/extending/validators.html">Using Validators</a></nav>
								<p>Sometimes you may need to access some data that will not be available until the entire document has been fully parsed and analyzed. For example, in order to be able to validate internal links, it is necessary to know in advance if the bookmark ID referenced in the link exists or not, either before (that&#8217;s easy) or even <em>after</em> the link.</p>
<p>Here&#8217;s the source code of the <a href="/glyph/book/macros/macros_inline.html#m_link"><code>link</code></a> macro:</p>
	<div class="CodeRay">
  <div class="code"><pre><span class="no"> 1</span> macro <span class="sy">:link</span> <span class="r">do</span>
<span class="no"> 2</span>   min_parameters <span class="i">1</span>
<span class="no"> 3</span>   max_parameters <span class="i">2</span>
<span class="no"> 4</span>   target = param <span class="i">0</span> 
<span class="no"> 5</span>   title = param <span class="i">1</span> 
<span class="no"> 6</span>   <span class="r">if</span> target.match <span class="rx"><span class="dl">/</span><span class="k">^#</span><span class="dl">/</span></span> <span class="r">then</span>
<span class="no"> 7</span>     <span class="iv">@node</span>[<span class="sy">:document</span>].links &lt;&lt; target 
<span class="no"> 8</span>     anchor = target.gsub <span class="rx"><span class="dl">/</span><span class="k">^#</span><span class="dl">/</span></span>, <span class="s"><span class="dl">'</span><span class="dl">'</span></span>
<span class="no"> 9</span>     bmk = bookmark? anchor
<span class="no"><strong>10</strong></span>     <span class="r">if</span> !bmk <span class="r">then</span>
<span class="no">11</span>       placeholder <span class="r">do</span> |document|
<span class="no">12</span>         bmk = document.bookmark?(anchor)
<span class="no">13</span>         macro_error <span class="s"><span class="dl">&quot;</span><span class="k">Bookmark '</span><span class="il"><span class="idl">#{</span>anchor<span class="idl">}</span></span><span class="k">' does not exist</span><span class="dl">&quot;</span></span> <span class="r">unless</span> bmk
<span class="no">14</span>         bmk_title = title
<span class="no">15</span>         bmk_title = bmk.title <span class="r">if</span> bmk_title.blank?
<span class="no">16</span>         <span class="iv">@data</span>[<span class="sy">:target</span>] = bmk.link(<span class="iv">@source_file</span>)
<span class="no">17</span>         <span class="iv">@data</span>[<span class="sy">:title</span>] = bmk_title
<span class="no">18</span>         render
<span class="no">19</span>       <span class="r">end</span>
<span class="no"><strong>20</strong></span>     <span class="r">else</span>
<span class="no">21</span>       bmk_title = title
<span class="no">22</span>       bmk_title = bmk.title <span class="r">if</span> bmk_title.blank?
<span class="no">23</span>       <span class="iv">@data</span>[<span class="sy">:target</span>] = bmk.link(<span class="iv">@source_file</span>)
<span class="no">24</span>       <span class="iv">@data</span>[<span class="sy">:title</span>] = bmk_title
<span class="no">25</span>       render
<span class="no">26</span>     <span class="r">end</span>
<span class="no">27</span>   <span class="r">else</span>
<span class="no">28</span>     <span class="c"># Code omitted...</span>
<span class="no">29</span>   <span class="r">end</span>
<span class="no"><strong>30</strong></span> <span class="r">end</span></pre></div>
</div>

	<p>If there&#8217;s already a bookmark stored in the current document, then it is possible to retrieve its title and use it as link text. Otherwise, it is necessary to wait until the entire document has been fully processed and then check if the bookmark exists. To do so, use the <code>placeholder</code> method. When called, this method returns an unique placeholder, which is then substituted with the value of the block, right before the document is finalized.</p>
<p>Within the <code>placeholder</code> block, the <code>document</code> parameter is, by all means, the fully analyzed document.</p>
							<nav class="navigation"><a href="/glyph/book/extending/bookmarks_headers.html">Bookmarks and Headers</a> | <a href="/glyph/book/index.html">Contents</a> | <a href="/glyph/book/extending/validators.html">Using Validators</a></nav>
										<nav id="sharing-buttons">
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="h3rald">Tweet</a>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<g:plusone size="medium"></g:plusone>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
</nav>
					</section>
				</article>
					
			
			<footer>
				<section class="ads">
					<script type="text/javascript"><!--
						google_ad_client = "pub-2871497824158668";
						/* 728x90, created 9/10/10 */
						google_ad_slot = "3963343166";
						google_ad_width = 728;
						google_ad_height = 90;
						//-->
					</script>
					<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
					</script>
				</section>
				<section>
					<nav>
						<a href="/about/">ABOUT</a>|<a href="/contact/">CONTACT</a>
					</nav>
					<p>H3RALD Web Site v8.1.2 &copy; 2004 &mdash; 2011 <em>Fabio Cevasco</em></p>
				</section>
			</footer>
		</section><!-- #container end -->
		
		
 <!-- Start Google Analytics --> 
 <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18587377-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
 </script> 
 <!-- End Google Analytics --> 
 <!-- Start of StatCounter Code --> 
  <script type="text/javascript"> 
	var sc_project=6193656; 
	var sc_invisible=1; 
	var sc_security="57f7ee2a"; 
	</script> 
	<script type="text/javascript" src="http://www.statcounter.com/counter/counter_xhtml.js"></script> 
	<!-- End of StatCounter Code --> 
	</body>
</html>